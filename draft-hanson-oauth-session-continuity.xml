<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.6.2 (Ruby 2.6.8) -->


<!DOCTYPE rfc  [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">

<!ENTITY RFC6749 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6749.xml">
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY I-D.wdenniss-oauth-device-posture SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.wdenniss-oauth-device-posture.xml">
<!ENTITY RFC7662 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7662.xml">
]>


<rfc ipr="trust200902" docName="draft-hanson-oauth-scss-00" category="std" consensus="true" submissionType="IETF">
  <front>
    <title abbrev="OAuth 2.0 SCSS">OAuth 2.0 Session Continuity and Signal Sharing</title>

    <author initials="J." surname="Hanson" fullname="Jared Hanson">
      <organization>Okta</organization>
      <address>
        <email>jared.hanson@okta.com</email>
      </address>
    </author>
    <author initials="K." surname="McGuinness" fullname="Karl McGuinness">
      <organization>Okta</organization>
      <address>
        <email>kmcguinness@okta.com</email>
      </address>
    </author>

    <date year="2022" month="March" day="15"/>

    <area>Security</area>
    <workgroup>Web Authorization Protocol</workgroup>
    

    <abstract>


<t>This specification defines a mechanism in which clients and resource servers can
share session signals with an authorization server.  These signals are
transported using existing OAuth 2.0 endpoints, providing a lightweight approach
to continuous authorization.</t>



    </abstract>



  </front>

  <middle>


<section anchor="introduction"><name>Introduction</name>

<t>In OAuth, an authorization server issues access tokens to clients, which are
used to access protected resources hosted by a resource server.  Prior to
issuing tokens, the authorization server authenticates the end-user and obtains
consent.  This interaction establishes a session in which the end-user accesses
both the authorization server and one or more applications.</t>

<t>These sessions can be long-lived, lasting for days or months.  During this time,
the status of the end-user and her device, such as location, network address, or
security posture, may change - requring a change in access privileges.
Unfortunately, typical OAuth deployments determine access only at the time of
authentication and lack awareness of dynamically changing information about
ongoing sessions.</t>

<t>This specification defines a mechanism in which clients and resource servers can
share session signals with an authorization server.  These signals are
transported using existing OAuth 2.0 endpoints.  Use of existing endpoints is
intended to provide a lightweight approach to continuous authorization, while
complimenting future protocols that provide real-time access evaluation using a
publish-subscribe approach.</t>

<section anchor="client-profiles"><name>Client Profiles</name>

<t>This specification has been designed around the client profiles defined in
Section 2.1 of <xref target="RFC6749"/>:</t>

<dl newline="true">
  <dt>web application:</dt>
  <dd>
    <t>A web application is a confidential client running on a web server.  Resource
owners access the client via an HTML user interface rendered in a user-agent on
the device used by the resource owner.  The client credentials as well as any
access token issued to the client are stored on the web server and are not
exposed to or accessible by the resource owner.</t>
  </dd>
  <dt>user-agent-based application:</dt>
  <dd>
    <t>A user-agent-based application is a public client in which the client code is
downloaded from a web server and executes within a user-agent (e.g., web
browser) on the device used by the resource owner.  Protocol data and
credentials are easily accessible (and often visible) to the resource owner.
Since such applications reside within the user-agent, they can make seamless use
of the user-agent capabilities when requesting authorization.</t>
  </dd>
  <dt>native application:</dt>
  <dd>
    <t>A native application is a public client installed and executed on the device
used by the resource owner.  Protocol data and credentials are accessible to the
resource owner.  It is assumed that any client authentication credentials
included in the application can be extracted.  On the other hand, dynamically
issued credentials such as access tokens or refresh tokens can receive an
acceptable level of protection.  At a minimum, these credentials are protected
from hostile servers with which the application may interact.  On some
platforms, these credentials might be protected from other applications residing
on the same device.</t>
  </dd>
</dl>

</section>
<section anchor="token-locality"><name>Token Locality</name>

<t>After obtaining approval of the end-user via interaction within the end-user's
user-agent, OAuth issues delegation-specific access tokens and refresh tokens to
clients.  This specification defines two token localities, based on where tokens
reside relative to the user-agent in which the issuance was approved:</t>

<dl newline="true">
  <dt>off device:</dt>
  <dd>
    <t>A token is off device when it resides with an application that is not located
on the same device as the end-user's user-agent.  Tokens issued to a web
application are off device, as the application runs on a web server acceessed
remotely via the user-agent.</t>
  </dd>
  <dt>on device:</dt>
  <dd>
    <t>A token is on device when it resides with an application that is located on
the same device as the end-user's user-agent.  Tokens issued to native
native applications and user-agent-based applications are on device, as the
application is executing either on the device or within the user-agent itself.</t>
  </dd>
</dl>

</section>
<section anchor="notational-conventions"><name>Notational Conventions</name>

<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCPÂ 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
appear in all capitals, as shown here.</t>

</section>
</section>
<section anchor="signal-sharing"><name>Signal Sharing</name>

<section anchor="refreshing-an-access-token"><name>Refreshing an Access Token</name>

<section anchor="from-on-device"><name>From On Device</name>

<t>A native application possessing a refresh token that is on device shares signals
by making a refresh request that includes device posture, as defined in section
6 of <xref target="I-D.wdenniss-oauth-device-posture"/>.</t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded

  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
  client_id=s6BhdRkqt3&device_posture=%7B%22screen_lock%22%3Atrue%2C
  %22device_os%22%3A%22iOS%22%2C%22device_os_version%22%3A%2211.1%22
  %7D
]]></artwork></figure>

</section>
<section anchor="from-off-device"><name>From Off Device</name>

<t>A web application posessing a refresh token that is off device shares signals by
making a refresh request that includes user-agent posture, as defined by User
Agent Posture Signals.</t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /token HTTP/1.1
  Host: server.example.com
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
  Content-Type: application/x-www-form-urlencoded

  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
  client_id=s6BhdRkqt3&user_agent_posture=%7B%22user_agent%22%3A%22Mozilla%2F5.0
  %20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_14_5%29%20AppleWebKit%2F537.36
  %20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F75.0.3770.142%20Safari%2F537.36%22
  %2C%22ip_address%22%3A%2293.184.216.34%22%7D
]]></artwork></figure>

<t>The client MUST only include user-agent posture in online access scenarios.
Refresh tokens used in offline scenarios, when the end-user is not present, are
decoupled from the session and lack end-user user agent context.</t>

</section>
</section>
<section anchor="token-introspection"><name>Token Introspection</name>

<section anchor="introspection-request"><name>Introspection Request</name>

<t>A resource server querying for to determine the state of an access token shares
signals by making an by making an introspection request to the introspection
endpoint, as defined in Section 2.1 of <xref target="RFC7662"/>.</t>

<t>In addition to the parameters defined by Section 2.1 of <xref target="RFC7662"/>, the
following parameters are also defined:</t>

<dl>
  <dt>user_agent_posture</dt>
  <dd>
    <t>OPTIONAL. URL-encoded JSON dictionary, containing user-agent posture signals,
as defined by User Agent Posture Signals.</t>
  </dd>
</dl>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /introspect HTTP/1.1
  Host: server.example.com
  Accept: application/json
  Content-Type: application/x-www-form-urlencoded
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

  token=mF_9.B5f-4.1JqM&token_type_hint=access_token
  &user_agent_posture=%7B%22user_agent%22%3A%22Mozilla%2F5.0
  %20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_14_5%29%20AppleWebKit%2F537.36
  %20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F75.0.3770.142%20Safari%2F537.36%22
  %2C%22ip_address%22%3A%2293.184.216.34%22%7D
]]></artwork></figure>

<t>Note that the locality of an access token is always off device when presented to
a resource server.</t>

</section>
</section>
</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC6749;
&RFC2119;
&RFC8174;
&I-D.wdenniss-oauth-device-posture;
&RFC7662;


    </references>




  </back>

<!-- ##markdown-source:
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

-->

</rfc>

