<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.12 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC6749 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6749.xml">
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY I-D.wdenniss-oauth-device-posture SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.wdenniss-oauth-device-posture.xml">
<!ENTITY RFC7662 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7662.xml">
]>


<rfc docName="draft-hanson-oauth-scss-00" category="std">

  <front>
    <title abbrev="OAuth 2.0 SCSS">OAuth 2.0 Session Continuity and Signal Sharing</title>

    <author initials="J." surname="Hanson" fullname="Jared Hanson">
      <organization>Okta</organization>
      <address>
        <email>jared.hanson@okta.com</email>
      </address>
    </author>
    <author initials="K." surname="McGuinness" fullname="Karl McGuinness">
      <organization>Okta</organization>
      <address>
        <email>kmcguinness@okta.com</email>
      </address>
    </author>

    <date year="2019" month="October" day="30"/>

    <area>Security</area>
    <workgroup>Web Authorization Protocol</workgroup>
    

    <abstract>


<t>This specification defines a mechanism in which clients and resource servers can
share session signals with an authorization server.  These signals are
transported using existing OAuth 2.0 endpoints, providing a lightweight approach
to continuous authorization.</t>



    </abstract>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>In OAuth, an authorization server issues access tokens to clients, which are
used to access protected resources hosted by a resource server.  Prior to
issuing tokens, the authorization server authenticates the end-user and obtains
consent.  This interaction establishes a session in which the end-user accesses
both the authorization server and one or more applications.</t>

<t>These sessions can be long-lived, lasting for days or months.  During this time,
the status of the end-user and her device, such as location, network address, or
security posture, may change - requring a change in access privileges.
Unfortunately, typical OAuth deployments determine access only at the time of
authentication and lack awareness of dynamically changing information about
ongoing sessions.</t>

<t>This specification defines a mechanism in which clients and resource servers can
share session signals with an authorization server.  These signals are
transported using existing OAuth 2.0 endpoints.  Use of existing endpoints is
intended to provide a lightweight approach to continuous authorization, while
complimenting future protocols that provide real-time access evaluation using a
publish-subscribe approach.</t>

<section anchor="client-profiles" title="Client Profiles">

<t>This specification has been designed around the client profiles defined in
Section 2.1 of <xref target="RFC6749"/>:</t>

<t><list style="hanging">
  <t hangText='web application:'><vspace blankLines='0'/>
  A web application is a confidential client running on a web server.  Resource
owners access the client via an HTML user interface rendered in a user-agent on
the device used by the resource owner.  The client credentials as well as any
access token issued to the client are stored on the web server and are not
exposed to or accessible by the resource owner.</t>
  <t hangText='user-agent-based application:'><vspace blankLines='0'/>
  A user-agent-based application is a public client in which the client code is
downloaded from a web server and executes within a user-agent (e.g., web
browser) on the device used by the resource owner.  Protocol data and
credentials are easily accessible (and often visible) to the resource owner.
Since such applications reside within the user-agent, they can make seamless use
of the user-agent capabilities when requesting authorization.</t>
  <t hangText='native application:'><vspace blankLines='0'/>
  A native application is a public client installed and executed on the device
used by the resource owner.  Protocol data and credentials are accessible to the
resource owner.  It is assumed that any client authentication credentials
included in the application can be extracted.  On the other hand, dynamically
issued credentials such as access tokens or refresh tokens can receive an
acceptable level of protection.  At a minimum, these credentials are protected
from hostile servers with which the application may interact.  On some
platforms, these credentials might be protected from other applications residing
on the same device.</t>
</list></t>

</section>
<section anchor="token-locality" title="Token Locality">

<t>After obtaining approval of the end-user via interaction within the end-user’s
user-agent, OAuth issues delegation-specific access tokens and refresh tokens to
clients.  This specification defines two token localities, based on where tokens
reside relative to the user-agent in which the issuance was approved:</t>

<t><list style="hanging">
  <t hangText='off device:'><vspace blankLines='0'/>
  A token is off device when it resides with an application that is not located
on the same device as the end-user’s user-agent.  Tokens issued to a web
application are off device, as the application runs on a web server acceessed
remotely via the user-agent.</t>
  <t hangText='on device:'><vspace blankLines='0'/>
  A token is on device when it resides with an application that is located on
the same device as the end-user’s user-agent.  Tokens issued to native
native applications and user-agent-based applications are on device, as the
application is executing either on the device or within the user-agent itself.</t>
</list></t>

</section>
<section anchor="notational-conventions" title="Notational Conventions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL
NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”,
“MAY”, and “OPTIONAL” in this document are to be interpreted as
described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
appear in all capitals, as shown here.</t>

</section>
</section>
<section anchor="signal-sharing" title="Signal Sharing">

<section anchor="refreshing-an-access-token" title="Refreshing an Access Token">

<section anchor="from-on-device" title="From On Device">

<t>A native application possessing a refresh token that is on device shares signals
by making a refresh request that includes device posture, as defined in section
6 of <xref target="I-D.wdenniss-oauth-device-posture"/>.</t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded

  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
  client_id=s6BhdRkqt3&device_posture=%7B%22screen_lock%22%3Atrue%2C
  %22device_os%22%3A%22iOS%22%2C%22device_os_version%22%3A%2211.1%22
  %7D
]]></artwork></figure>

</section>
<section anchor="from-off-device" title="From Off Device">

<t>A web application posessing a refresh token that is off device shares signals by
making a refresh request that includes user-agent posture, as defined by User
Agent Posture Signals.</t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /token HTTP/1.1
  Host: server.example.com
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
  Content-Type: application/x-www-form-urlencoded

  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
  client_id=s6BhdRkqt3&user_agent_posture=%7B%22user_agent%22%3A%22Mozilla%2F5.0
  %20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_14_5%29%20AppleWebKit%2F537.36
  %20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F75.0.3770.142%20Safari%2F537.36%22
  %2C%22ip_address%22%3A%2293.184.216.34%22%7D
]]></artwork></figure>

<t>The client MUST only include user-agent posture in online access scenarios.
Refresh tokens used in offline scenarios, when the end-user is not present, are
decoupled from the session and lack end-user user agent context.</t>

</section>
</section>
<section anchor="token-introspection" title="Token Introspection">

<section anchor="introspection-request" title="Introspection Request">

<t>A resource server querying for to determine the state of an access token shares
signals by making an by making an introspection request to the introspection
endpoint, as defined in Section 2.1 of <xref target="RFC7662"/>.</t>

<t>In addition to the parameters defined by Section 2.1 of <xref target="RFC7662"/>, the
following parameters are also defined:</t>

<t><list style="hanging">
  <t hangText='user_agent_posture'>
  OPTIONAL. URL-encoded JSON dictionary, containing user-agent posture signals,
as defined by User Agent Posture Signals.</t>
</list></t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /introspect HTTP/1.1
  Host: server.example.com
  Accept: application/json
  Content-Type: application/x-www-form-urlencoded
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

  token=mF_9.B5f-4.1JqM&token_type_hint=access_token
  &user_agent_posture=%7B%22user_agent%22%3A%22Mozilla%2F5.0
  %20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_14_5%29%20AppleWebKit%2F537.36
  %20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F75.0.3770.142%20Safari%2F537.36%22
  %2C%22ip_address%22%3A%2293.184.216.34%22%7D
]]></artwork></figure>

<t>Note that the locality of an access token is always off device when presented to
a resource server.</t>

</section>
</section>
</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC6749;
&RFC2119;
&RFC8174;
&I-D.wdenniss-oauth-device-posture;
&RFC7662;


    </references>




  </back>

<!-- ##markdown-source:
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
Gwj9XYMHHwAA

-->

</rfc>

