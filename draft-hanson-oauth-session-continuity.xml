<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.6.2 (Ruby 2.6.8) -->


<!DOCTYPE rfc  [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">

<!ENTITY RFC6749 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6749.xml">
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY I-D.wdenniss-oauth-device-posture SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.wdenniss-oauth-device-posture.xml">
<!ENTITY RFC7662 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7662.xml">
]>


<rfc ipr="trust200902" docName="draft-hanson-oauth-session-continuity-latest" category="std" consensus="true" submissionType="IETF">
  <front>
    <title>OAuth 2.0 Session Continuity</title>

    <author initials="J." surname="Hanson" fullname="Jared Hanson">
      <organization>Okta</organization>
      <address>
        <email>jared.hanson@okta.com</email>
      </address>
    </author>
    <author initials="K." surname="McGuinness" fullname="Karl McGuinness">
      <organization>Okta</organization>
      <address>
        <email>kmcguinness@okta.com</email>
      </address>
    </author>

    <date year="2022" month="March" day="16"/>

    <area>Security</area>
    <workgroup>Web Authorization Protocol</workgroup>
    

    <abstract>


<t>This specification defines a mechanism by which an OAuth 2.0 authorization
server can maintain a logical authorization session in which protected resources
can be accessed over a period time.  This specification also extends existing
OAuth 2.0 endpoints so that dynamic context about the session, such as user
location or device health, can be communicated to the authorization server
throughout the lifetime of the session.  Combined, this functionality provides
a lightweight approach to continuous authorization.</t>



    </abstract>



  </front>

  <middle>


<section anchor="introduction"><name>Introduction</name>

<t>In OAuth 2.0 <xref target="RFC6749"/>, an authorization server issues an access token and
refresh token to a client.  The client uses the access token to access protected
resources hosted by a resource server, and uses the refresh token to obtain
access tokens from the authorization server.  While the authorization server,
client, and resource server are separate entities, the usage of the access token
and refresh token forms a logical authorization session shared between each
entity.</t>

<t>The access token and refresh token are issued by the authorization server after
authenticating the resource owner and obtaining authorization.  Authorization is
typically obtained by interacting with the resource owner via the authorization
endpoint.  Once authorization has been obtained, issuance of the tokens
initiates an ongoing session in which protected resources may be accessed over
a period of hours or even days.</t>

<t>During this time, the status of the resource owner and her device, such as role,
location, or security posture, may change.  Increasingly, access to protected
resources needs to be based on this dynamically changing context.  However,
typical OAuth deployments evaluate this context infrequently - often only at
session initiation.</t>

<t>This specification provides mechanisms by which an OAuth deployment can both
increase the frequency of access policy evaluation during a session, as well as
increase awareness of dynamically changing context about the session used to
inform policy decisions.  Combined, this functionality provides a lightweight
approach to continuous authorization.</t>

<section anchor="client-profiles"><name>Client Profiles</name>

<t>This specification has been designed around the client profiles defined in
Section 2.1 of <xref target="RFC6749"/>:</t>

<dl newline="true">
  <dt>web application:</dt>
  <dd>
    <t>A web application is a confidential client running on a web server.  Resource
owners access the client via an HTML user interface rendered in a user-agent on
the device used by the resource owner.  The client credentials as well as any
access token issued to the client are stored on the web server and are not
exposed to or accessible by the resource owner.</t>
  </dd>
  <dt>user-agent-based application:</dt>
  <dd>
    <t>A user-agent-based application is a public client in which the client code is
downloaded from a web server and executes within a user-agent (e.g., web
browser) on the device used by the resource owner.  Protocol data and
credentials are easily accessible (and often visible) to the resource owner.
Since such applications reside within the user-agent, they can make seamless use
of the user-agent capabilities when requesting authorization.</t>
  </dd>
  <dt>native application:</dt>
  <dd>
    <t>A native application is a public client installed and executed on the device
used by the resource owner.  Protocol data and credentials are accessible to the
resource owner.  It is assumed that any client authentication credentials
included in the application can be extracted.  On the other hand, dynamically
issued credentials such as access tokens or refresh tokens can receive an
acceptable level of protection.  At a minimum, these credentials are protected
from hostile servers with which the application may interact.  On some
platforms, these credentials might be protected from other applications residing
on the same device.</t>
  </dd>
</dl>

</section>
<section anchor="token-locality"><name>Token Locality</name>

<t>After obtaining approval of the end-user via interaction within the end-user's
user-agent, OAuth issues delegation-specific access tokens and refresh tokens to
clients.  This specification defines two token localities, based on where tokens
reside relative to the user-agent in which the issuance was approved:</t>

<dl newline="true">
  <dt>off device:</dt>
  <dd>
    <t>A token is off device when it resides with an application that is not located
on the same device as the end-user's user-agent.  Tokens issued to a web
application are off device, as the application runs on a web server acceessed
remotely via the user-agent.</t>
  </dd>
  <dt>on device:</dt>
  <dd>
    <t>A token is on device when it resides with an application that is located on
the same device as the end-user's user-agent.  Tokens issued to native
native applications and user-agent-based applications are on device, as the
application is executing either on the device or within the user-agent itself.</t>
  </dd>
</dl>

</section>
<section anchor="notational-conventions"><name>Notational Conventions</name>

<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCPÂ 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
appear in all capitals, as shown here.</t>

</section>
</section>
<section anchor="signal-sharing"><name>Signal Sharing</name>

<section anchor="refreshing-an-access-token"><name>Refreshing an Access Token</name>

<section anchor="from-on-device"><name>From On Device</name>

<t>A native application possessing a refresh token that is on device shares signals
by making a refresh request that includes device posture, as defined in section
6 of <xref target="I-D.wdenniss-oauth-device-posture"/>.</t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded

  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
  client_id=s6BhdRkqt3&device_posture=%7B%22screen_lock%22%3Atrue%2C
  %22device_os%22%3A%22iOS%22%2C%22device_os_version%22%3A%2211.1%22
  %7D
]]></artwork></figure>

</section>
<section anchor="from-off-device"><name>From Off Device</name>

<t>A web application posessing a refresh token that is off device shares signals by
making a refresh request that includes user-agent posture, as defined by User
Agent Posture Signals.</t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /token HTTP/1.1
  Host: server.example.com
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
  Content-Type: application/x-www-form-urlencoded

  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
  client_id=s6BhdRkqt3&user_agent_posture=%7B%22user_agent%22%3A%22Mozilla%2F5.0
  %20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_14_5%29%20AppleWebKit%2F537.36
  %20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F75.0.3770.142%20Safari%2F537.36%22
  %2C%22ip_address%22%3A%2293.184.216.34%22%7D
]]></artwork></figure>

<t>The client MUST only include user-agent posture in online access scenarios.
Refresh tokens used in offline scenarios, when the end-user is not present, are
decoupled from the session and lack end-user user agent context.</t>

</section>
</section>
<section anchor="token-introspection"><name>Token Introspection</name>

<section anchor="introspection-request"><name>Introspection Request</name>

<t>A resource server querying for to determine the state of an access token shares
signals by making an by making an introspection request to the introspection
endpoint, as defined in Section 2.1 of <xref target="RFC7662"/>.</t>

<t>In addition to the parameters defined by Section 2.1 of <xref target="RFC7662"/>, the
following parameters are also defined:</t>

<dl>
  <dt>user_agent_posture</dt>
  <dd>
    <t>OPTIONAL. URL-encoded JSON dictionary, containing user-agent posture signals,
as defined by User Agent Posture Signals.</t>
  </dd>
</dl>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /introspect HTTP/1.1
  Host: server.example.com
  Accept: application/json
  Content-Type: application/x-www-form-urlencoded
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

  token=mF_9.B5f-4.1JqM&token_type_hint=access_token
  &user_agent_posture=%7B%22user_agent%22%3A%22Mozilla%2F5.0
  %20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_14_5%29%20AppleWebKit%2F537.36
  %20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F75.0.3770.142%20Safari%2F537.36%22
  %2C%22ip_address%22%3A%2293.184.216.34%22%7D
]]></artwork></figure>

<t>Note that the locality of an access token is always off device when presented to
a resource server.</t>

</section>
</section>
</section>
<section anchor="comparison-to-caep"><name>Comparison to CAEP</name>

<t>Use of existing endpoints is
intended to provide a lightweight approach to continuous authorization, while
complimenting future protocols that provide real-time access evaluation using a
publish-subscribe approach.</t>

</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC6749;
&RFC2119;
&RFC8174;
&I-D.wdenniss-oauth-device-posture;
&RFC7662;


    </references>




  </back>

<!-- ##markdown-source:
H4sIABsfMmIAA+1Z624buRX+z6dgHXgvgEYryY69ERCgjh0nTuw4azvItn8M
aoaSuJoZaoccK8oifZY+S5+s3yE5N0lJs9s/bVEDljQz5Lmf75zDiaKIJTrO
RSbHPCnE1EZzkRudR1qUdh4ZaYzCVaxzq/JS2XWUCiuNZTG+ZrpYj7mxCVPL
YsxtURo7GgyeDEbMlJNMub136yVoXzy/O2fMKpvi4voEtPmoP+C3nj4/rekz
4quLMeM8wj/nKjdj/qrPXzq53C0v7itRyKR9Wxcz0F5Y4a5kJlQ65r/Qqr5X
6s8aD/uxzrrEX/f5VfyiVHkOaVoMXosi3Xyyk8cii2dhUcOCgbEYQ8O4LEiv
lS4Ws0KXyzF/Lyf8xKmpPgpL+r8ttNWxThmLooiLibGFiC1jd3NluFnKWE1V
7JcmcqrAiQueyRh6KZPxyZqv5iqec5G3jCvaLJiRxYMseIwlkDq3+AeNVM9A
OO2u5cHtME+gu4R8MrawdyGNLotYGkaUJpKLGBcGTzSRF3wpC6UTblUm+5zv
UECkRnP5wco8MfhWBp6fsUZs3F9qCIh9mtu5sDxZwyEq5hSF2Aj76NLikawE
7XFTkvaGl1CTpTqw0gXM9aBiyedSpHbe40FoOCgrc5IIglvtaG2agMzF7Bwu
m80rfqmaStKM62mbPxQ91dkEfkl6uA+Vp2UeEx2RwvdkvgeVwGYwuJrN7UrS
JxdLPBAQHBKEDNOl6QrSZz4mMpUkqWTsEb/IbaGT0pFn7KLt8d9++9PN+enR
8eGTT596FAy7dOLIy5ICKA++A/uFxEWesEJO4eB5uAOxBI9TJXPrXCnDBVnZ
eJu1CdByf12HC6vDhc+1IWMjVEUdREEiEjVpiG4JoScUrazNDBYudPZZv0Hc
93OVys8u6DGvime9IQ9H6uLnUhSID8QjYEtJ03PESiNmtfvbEjFPqC36VBeZ
+ZdJZuYOyCYSYYFNEgHBHM91nwBAbnlpgwsJ61zqjPs5hTmwHfFMj4g4JUg+
C+YOyutVTuvAwBucFnRjkW/AljLMrpekW7oOm7wUSF9JCEYkVgrRuYPRgxLb
0rIq+8HrOo83dZkjxSdkpYpZz6kuaGXwiQ8PBvGtolJFca7zmSZRvgbXgI7r
LVxjNa6BC9CgMIQt8gGSJGJt4KgzoLwzKJKfEMJHi7HCIqODaDssPZcVRDUY
VuhU9moQ6xEnE6oIXyKLygKLSUqC/xmh7EUeo9gYCJCue0287MzDXMrEPYSO
E+EUzL3YAWadMx1pUihgLpi81CvpMie4POBOIpepXmeSAFs+iLSknHH0KrhW
OcL11xIrQDiCMSw5MMeFsKxxifOXR7wdVaOC0KbqmR1lrxHGI722c0SCM47H
giBJvCafVGilU4UbQXhXY70zRVNf4JaVTJHCpqEnVkg9KvpE60vG2y5YBHZU
eECMQKISIYHG9Nh8bUHhnYLCvrKgPHrETz2Qo++YAibNTpPXyQZGakaZLVAM
EbS2qQTLQCC0JQn8yNDyuP2j/pAs0y5KY8Z+G/MHsxSxfLo32PvEVuiFIHYa
mI7ZmJ/wjZvIcSpEOp9CZ2iF2AvsizJ3MEVthdtVw/9NCHjmcs3USdGITviD
GHl5d3Xp2gYPWlNIhkTNE1k4bUCXHkZAfewBQBGF0FQ4JwbM7eZ2t1wiXoLc
phVIYL7u1LQKxUM/Eja7WmR1USWqbOnpIIQW5Noy+QHg4LcDMTxhNUEN3C0h
Y41ekQeCLT98aYV3yrKcpNSZeVlrXG3JH+uE6hPGjFWeapGAiivdYlMP+QEg
R4BNBWPT8N/J/qzfoy1sUugVHnxfmeNrnFH110BrK1yn0/EJLEjwSYjUmO07
VwkdWD0od+v7yjWbprxVVIA8fjcWMrQOEVsp5NuHSiVXINahH18QMogspVjA
EhYKRssAsViKiUpdJwIjQyiHZK553krwHD8e5LY/t+/v9iLKVpqSuxu3JF1z
s99nbr5p7padvU3ZFpEL64RDTmQU1TQIIGPqtGg1MpCsRZ8AOi0Tn72uwWip
G/p/gDK1J5gMqc1wq1AqEIhAbiBuC8xZSMq2AlWh7jakSLpOY2Ycs0LG0tnc
969LK0jnFJU0JXAMFTo0V5amOlTCrMxceKDIbBquKekui6irpj7X55HPnVYO
tlWnjqHqy7zaRmeSLTHQu0Z1F8fMzSmTFlufvN5Y27FOk1yIE4MZOgSLLzl3
DuMu0dZQCWPshBrSdqtJxQs1uOqWgMGRw2UC6rqhBPVWOlVrvjWsnVm+GQhz
TiJTOXNCRlV92/DcVk9NT8KAYHYPsdUUblc6gHfqFXODQt1XIVGLuiUNaFDI
1KdhAJNWknfws25sVxRqzjgy2S6gejoNZvY5XpUS3jzweKFswKMQJTT/tcLD
JRi2oZQ4XSjEtl1JYd81fEt+MpU3X1PJHMyzNiOK4ka2XkWxvQRl3WzWdOcz
15HDkBmiEWhdjRAtERhz3tllj/yPmCOYoqr8/44pPPruAGdTzb+fLbY+92sN
KqOxDST3WE3JJJXL0G6JBELtLEWwhZHp1KfpG22FbzTpVO6BkAD8/SS6QMFa
6QLzw97Vu9u7vZ7/5m+u3e+b5z+9u7h5fka/b1+eXF7WP1hYcfvy+t3lWfOr
2Xl6fXX1/M2Z34y7vHOL7V2d/GXPD+t712/vLq7fnFzueYCnyUXHZVY1S360
cYCxLCT5Dk073BwXauKLwrPTt//4+/AwdKaj4RCdabj4cXh8iAuKEM/NzSn+
kuo1WVyKwjWG6OJQlRVqpXEOMXOULproCPDYI36LphlWvMV8T7hIxr3xKOPg
LucnHoVcoNDjR/ycwBXIfOaLLNtZstHmuTHCTSgbhyUhaptYd6cLkM3JYhgq
NrqN7tbQSITNvniaan89cIp2j08DqRvXj0KHfxGd9VcoGxjMTDg79gSiQODT
JxjlnIbmDyJbpmE+DsWcGiCfTFOdpnpF8r28u3tbi1Y6bVGzc7PUhY1SscZQ
Xk/F37kMdkUd81COlhcT2sLQAQxPlEGJw8hUFtQfG+fR74Gjf6v/GDqWa4Tx
D96IxPmHYX/IaOY1dlwNFUHycIBMR9aUq/58u+WfHz5Eq9UqopoalUWKYRMd
cMKwZQb57T3GZ/k02P7ecfymc/XUvvj4cPDqenE++PnF458+jO7S1+8vTrDf
W+teJU/N0bN5crP41R584818H8z8dP/42f5ohGDH4HYP8Frgav/gxBal3B+d
ggiuwxZt/DN8qutb+j06bT+9p44CCtWrhjAKvojI8Vnbfq3YBbA3wbs5xzkH
fDlwm6LVjVz0muwrI7cFbLuiFynwjk6JT9yKt35FSFbzPxakneO6MX+GIQdt
/se/nooXN7fi4Hxw9XGZvz87z37K8Hv06v1/UGCTG++dGzeCu3lQR+aV/qjS
VOyPzh/3By7IB/ujH69EjDKgzXz/APsGF9ArxTdu45MifvAz/oeD++Hh/eP9
0RNcnEBd+V5OXitLxA6O+wdHNb3XdFbgkmSQqgXyafBCxgvtd57OEf+4d34M
EfoHx8eD/vAQKTW4FVMUgJpaSCCXamp5L5IEFmoy8clBf/jjYX80POofHNLd
jUxrHSu40uvqUwj9HZFPWI0lFG6h5zWxzCGPRqjfdHteN9LR+unUbahX9nzH
1GnKQ6eICmv8MXohUWRjXS7Takhon3dRKU1FvGgIuI8w24YzxtaY4F5yUMvt
33IQvnRuoZK6pCOU2Ty9x4NiTalImYVuIEETUGSkUXUk6w6LN99/eLxhDd7U
lTLvXqiOIDUG+W6+87A+zd4snzuPyI6PjkauTF5AsiRRvg/1ZOldREZ6dHDs
C2QcdLEGqVoE3PxNL+ECJXrXytl2uqF9rlqtPn93cxmFjOevbq/fALL8eWSx
7jkHhiluRwgGi/bYNgjz/1YQbtz8tUjshv8unv7i31z/XsD9I7COTR6Ds/P7
J/1nj6fRYX/46terb9xdB933aEvtU58SHrCx6f8ovBOFMSRJ33W4t8LhTGMX
qtARVroS6+15PECnfw+w9U7UjxCnOkPiKuOB4PTk+VvGkDfEqHpz3npfrujs
i96r+3kzvCTgv/+lMwG+SiVD6CIYabJycFq6JF2Gwz3jDVBxQR6lkXs3HvRv
vU/xSSmYO2c088iUEz+O1dL02T8BpWsxjosiAAA=

-->

</rfc>

