<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.6.2 (Ruby 2.6.8) -->


<!DOCTYPE rfc  [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">

<!ENTITY RFC6749 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6749.xml">
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY I-D.wdenniss-oauth-device-posture SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.wdenniss-oauth-device-posture.xml">
<!ENTITY RFC7662 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7662.xml">
]>


<rfc ipr="trust200902" docName="draft-hanson-oauth-session-continuity-latest" category="std" consensus="true" submissionType="IETF">
  <front>
    <title>OAuth 2.0 Session Continuity</title>

    <author initials="J." surname="Hanson" fullname="Jared Hanson">
      <organization>Okta</organization>
      <address>
        <email>jared.hanson@okta.com</email>
      </address>
    </author>
    <author initials="K." surname="McGuinness" fullname="Karl McGuinness">
      <organization>Okta</organization>
      <address>
        <email>kmcguinness@okta.com</email>
      </address>
    </author>

    <date year="2022" month="March" day="15"/>

    <area>Security</area>
    <workgroup>Web Authorization Protocol</workgroup>
    

    <abstract>


<t>This specification defines a mechanism by which an OAuth 2.0 authorization
server can maintain a logical authorization session in which protected resources
can be accessed over a period time.  This specification also extends existing
OAuth 2.0 endpoints so that dynamic context about the session, such as user
location or device health, can be communicated to the authorization server
throughout the lifetime of the session.  Combined, this functionality provides
a lightweight approach to continuous authorization.</t>



    </abstract>



  </front>

  <middle>


<section anchor="introduction"><name>Introduction</name>

<t>In OAuth, an authorization server issues access tokens to clients, which are
used to access protected resources hosted by a resource server.  Prior to
issuing tokens, the authorization server authenticates the end-user and obtains
consent.  This interaction establishes a session in which the end-user accesses
both the authorization server and one or more applications.</t>

<t>These sessions can be long-lived, lasting for days or months.  During this time,
the status of the end-user and her device, such as location, network address, or
security posture, may change - requring a change in access privileges.
Unfortunately, typical OAuth deployments determine access only at the time of
authentication and lack awareness of dynamically changing information about
ongoing sessions.</t>

<t>This specification defines a mechanism in which clients and resource servers can
share session signals with an authorization server.  These signals are
transported using existing OAuth 2.0 endpoints.  Use of existing endpoints is
intended to provide a lightweight approach to continuous authorization, while
complimenting future protocols that provide real-time access evaluation using a
publish-subscribe approach.</t>

<section anchor="client-profiles"><name>Client Profiles</name>

<t>This specification has been designed around the client profiles defined in
Section 2.1 of <xref target="RFC6749"/>:</t>

<dl newline="true">
  <dt>web application:</dt>
  <dd>
    <t>A web application is a confidential client running on a web server.  Resource
owners access the client via an HTML user interface rendered in a user-agent on
the device used by the resource owner.  The client credentials as well as any
access token issued to the client are stored on the web server and are not
exposed to or accessible by the resource owner.</t>
  </dd>
  <dt>user-agent-based application:</dt>
  <dd>
    <t>A user-agent-based application is a public client in which the client code is
downloaded from a web server and executes within a user-agent (e.g., web
browser) on the device used by the resource owner.  Protocol data and
credentials are easily accessible (and often visible) to the resource owner.
Since such applications reside within the user-agent, they can make seamless use
of the user-agent capabilities when requesting authorization.</t>
  </dd>
  <dt>native application:</dt>
  <dd>
    <t>A native application is a public client installed and executed on the device
used by the resource owner.  Protocol data and credentials are accessible to the
resource owner.  It is assumed that any client authentication credentials
included in the application can be extracted.  On the other hand, dynamically
issued credentials such as access tokens or refresh tokens can receive an
acceptable level of protection.  At a minimum, these credentials are protected
from hostile servers with which the application may interact.  On some
platforms, these credentials might be protected from other applications residing
on the same device.</t>
  </dd>
</dl>

</section>
<section anchor="token-locality"><name>Token Locality</name>

<t>After obtaining approval of the end-user via interaction within the end-user's
user-agent, OAuth issues delegation-specific access tokens and refresh tokens to
clients.  This specification defines two token localities, based on where tokens
reside relative to the user-agent in which the issuance was approved:</t>

<dl newline="true">
  <dt>off device:</dt>
  <dd>
    <t>A token is off device when it resides with an application that is not located
on the same device as the end-user's user-agent.  Tokens issued to a web
application are off device, as the application runs on a web server acceessed
remotely via the user-agent.</t>
  </dd>
  <dt>on device:</dt>
  <dd>
    <t>A token is on device when it resides with an application that is located on
the same device as the end-user's user-agent.  Tokens issued to native
native applications and user-agent-based applications are on device, as the
application is executing either on the device or within the user-agent itself.</t>
  </dd>
</dl>

</section>
<section anchor="notational-conventions"><name>Notational Conventions</name>

<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCPÂ 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
appear in all capitals, as shown here.</t>

</section>
</section>
<section anchor="signal-sharing"><name>Signal Sharing</name>

<section anchor="refreshing-an-access-token"><name>Refreshing an Access Token</name>

<section anchor="from-on-device"><name>From On Device</name>

<t>A native application possessing a refresh token that is on device shares signals
by making a refresh request that includes device posture, as defined in section
6 of <xref target="I-D.wdenniss-oauth-device-posture"/>.</t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded

  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
  client_id=s6BhdRkqt3&device_posture=%7B%22screen_lock%22%3Atrue%2C
  %22device_os%22%3A%22iOS%22%2C%22device_os_version%22%3A%2211.1%22
  %7D
]]></artwork></figure>

</section>
<section anchor="from-off-device"><name>From Off Device</name>

<t>A web application posessing a refresh token that is off device shares signals by
making a refresh request that includes user-agent posture, as defined by User
Agent Posture Signals.</t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /token HTTP/1.1
  Host: server.example.com
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
  Content-Type: application/x-www-form-urlencoded

  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
  client_id=s6BhdRkqt3&user_agent_posture=%7B%22user_agent%22%3A%22Mozilla%2F5.0
  %20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_14_5%29%20AppleWebKit%2F537.36
  %20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F75.0.3770.142%20Safari%2F537.36%22
  %2C%22ip_address%22%3A%2293.184.216.34%22%7D
]]></artwork></figure>

<t>The client MUST only include user-agent posture in online access scenarios.
Refresh tokens used in offline scenarios, when the end-user is not present, are
decoupled from the session and lack end-user user agent context.</t>

</section>
</section>
<section anchor="token-introspection"><name>Token Introspection</name>

<section anchor="introspection-request"><name>Introspection Request</name>

<t>A resource server querying for to determine the state of an access token shares
signals by making an by making an introspection request to the introspection
endpoint, as defined in Section 2.1 of <xref target="RFC7662"/>.</t>

<t>In addition to the parameters defined by Section 2.1 of <xref target="RFC7662"/>, the
following parameters are also defined:</t>

<dl>
  <dt>user_agent_posture</dt>
  <dd>
    <t>OPTIONAL. URL-encoded JSON dictionary, containing user-agent posture signals,
as defined by User Agent Posture Signals.</t>
  </dd>
</dl>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /introspect HTTP/1.1
  Host: server.example.com
  Accept: application/json
  Content-Type: application/x-www-form-urlencoded
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

  token=mF_9.B5f-4.1JqM&token_type_hint=access_token
  &user_agent_posture=%7B%22user_agent%22%3A%22Mozilla%2F5.0
  %20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_14_5%29%20AppleWebKit%2F537.36
  %20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F75.0.3770.142%20Safari%2F537.36%22
  %2C%22ip_address%22%3A%2293.184.216.34%22%7D
]]></artwork></figure>

<t>Note that the locality of an access token is always off device when presented to
a resource server.</t>

</section>
</section>
</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC6749;
&RFC2119;
&RFC8174;
&I-D.wdenniss-oauth-device-posture;
&RFC7662;


    </references>




  </back>

<!-- ##markdown-source:
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
ePwbnvgX7/4fpBMgAAA=

-->

</rfc>

